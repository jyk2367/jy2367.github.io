---
layout: default
title: 논리 데이터베이스 설계
parent: 데이터베이스 구축
grand_parent: 정보처리기사

nav_order: 4.1
---

- [데이터베이스 설계 시 고려사항](#데이터베이스-설계-시-고려사항)
- [데이터베이스 설계 순서](#데이터베이스-설계-순서)
- [개체(Entity)](#개체entity)
- [속성(Attribute)](#속성attribute)
- [관계(RelationShip)](#관계relationship)
- [관계형 데이터베이스 용어정리](#관계형-데이터베이스-용어정리)
  - [튜플](#튜플)
  - [도메인](#도메인)
- [키](#키)
- [무결성](#무결성)
  - [개체 무결성](#개체-무결성)
  - [도메인 무결성](#도메인-무결성)
  - [참조 무결성](#참조-무결성)
- [관계대수](#관계대수)
  - [Select](#select)
  - [Project](#project)
  - [Join](#join)
  - [Division](#division)
  - [일반 집합 연산자](#일반-집합-연산자)
  - [관계 해석](#관계-해석)
- [정규화](#정규화)
  - [정규화 목적](#정규화-목적)
  - [정규화 원칙](#정규화-원칙)
  - [이상(Anomaly)](#이상anomaly)
    - [삽입 이상(Insertion Anomaly)](#삽입-이상insertion-anomaly)
    - [삭제 이상(Deletion Anomaly)](#삭제-이상deletion-anomaly)
    - [갱신 이상(Update Anomaly)](#갱신-이상update-anomaly)
  - [정규화 과정](#정규화-과정)
    - [1NF(제1정규형)](#1nf제1정규형)
    - [2NF(제2정규형)](#2nf제2정규형)
    - [3NF(제3정규형)](#3nf제3정규형)
    - [BCNF(Boyce-Codd 정규형)](#bcnfboyce-codd-정규형)
    - [4NF](#4nf)
    - [5NF](#5nf)
- [시스템 카탈로그](#시스템-카탈로그)
  - [카탈로그 참조를 위한 DBMS내 모듈 시스템](#카탈로그-참조를-위한-dbms내-모듈-시스템)

# 데이터베이스 설계 시 고려사항
- 무결성 : 삽입 삭제 갱신 등의 연산 후에도 DB의 데이터는 제약조건을 항상 만족해야 함
- 일관성 : 질의에 대한 응답이 처음부터 끝까지 변함없이 일정해야 함
- 회복
- 보안
- 효율성
- 데이터베이스 확장

# 데이터베이스 설계 순서
1. 요구조건 분석
2. 개념적 설계 : 개념 스키마 설계(전체적인 논리적 구조), 트랜잭션 모델링, ER모델
3. 논리적 설계 : 논리 스키마 설(물리적인 저장장치 입장에서), 트랜잭션 인터페이스 설계, 데이터 모델(구조, 연산, 제약조건)
4. 물리적 설계 : 물리적 구조의 데이터로 변환
5. 구현

# 개체(Entity)
 사람이 생각하는 개념이나 정보단위 같은 현실세계의 대상체

 - ERD에서는 사각형 모양

# 속성(Attribute)
데이터의 가장 작은 논리적 단위로 파일 구조상의 데이터 항목 또는 필드에 해당
- ERD에서는 타원
- 다중값 속성은 이중타원
- 기본키 속성은 밑줄 타원
- 복합 속성은 복수 타원

# 관계(RelationShip)
개체 간의 관계 또는 속성 간의 논리적인 연결을 의미

- ERD에서는 마름모, 관계 기호

1:1  
1:N  
N:M  

# 관계형 데이터베이스 용어정리
![rdb_relation](/docs_images/rdb_relation.png)
- **릴레이션** : 데이터들을 표 형태로 표현한 것
- **속성** : 데이터베이스를 구성하는 가장 작은 논리
- **디그리(Degree,차수)**: 속성의 수

## 튜플
릴레이션을 구성하는 각각의 행(레코드)
- **카디널리티(Cardinality, 기수)** : 튜플의 수

## 도메인
하나의 속성이 취할 수 있는 같은 타입의 원자값들의 합

# 키
데이터베이스에서 조건에 만족하는 튜플을 찾거나 순서대로 정렬할 때, 튜플들을 서로 구분할 수 있는 기준이 되는 속성.
- **후보키(Candidate Key)** : 릴레이션을 구성하는 속성들 중 튜플을 유일하게 식별하기 위해 사용하는 속성들의 부분집합. 모든 릴레이션은 반드시 하나의 후보키를 가지며, 유일성과 최소성을 만족시켜야 함.
  - 유일성(Unique) : 하나의 키 값으로 하나의 튜플만을 유일하게 식별할 수 있어야 함.
  - 최소성(Minimality) : 모든 레코드들을 유일하게 식별하는데 꼭 필요한 속성으로만 구성.
- **기본키(Primary Key)** : 후보키 중에서 특별히 선정된 주키. 후보키의 성질을 가지고 null값을 가지지 않음.
- **대체키(Alternate Key)** : 후보키가 둘 이상일 때, 기본키를 제외한 나머지 후보키.
- **슈퍼키(Super Key)** : 한 릴레이션 내에 있는 속성들의 집합으로 구성된 키. 유일성은 만족하지만 최소성은 만족 못함.(ex){학번, 주민번호}, {학번, 성명}...
- **외래키(Foreign Key)** : 다른 릴레이션의 기본 키를 참조하는 속성 또는 속성들의 집합

# 무결성
DB에 저장된 값과 현실세계의 실제값의 일치하는 정확성

## 개체 무결성
기본 테이블의 기본키를 구성하는 어떤 속성도 NULL값이나 중복값을 가질 수 없다는 규정

## 도메인 무결성
주어진 속성 값이 정의된 도메인에 속한 값이어야 한다는 규정  

ex.  
<수강> 릴레이션의 '과목명' 속성에는 영어, 수학, 전산 세가지만 입력되도록 유효값이 지정된 경우 반드시 해당 값만 입력  
<수강> 릴레이션  
|학번|과목명|
|---|---|
|1001|영어|
|1001|전산|
|1002|영어|
|1002|수학|
|1003|수학|

## 참조 무결성
외래키 값은 NULL이거나 참조 릴레이션의 기본키 값과 동일해야 함.  
릴레이션은 참주할 수 없는 외래키 값을 가질 수 없다. 

ex.   
<수강> 릴레이션의 '학번'속성에는 <학생> 릴레이션의 '학번' 속성에 없는 값은 입력할 수 없다.  
<학생> 릴레이션의 기본키가 '학번+이름'이였다면 <수강>릴레이션의 외래 키도 '학번+이름'으로 구성되어져야 함.

# 관계대수
RDB에서 원하는 정보와 그 정보를 검색하기 위해 어떻게 유도하는가를 기술하는 **절차적 언어**.
- 순수 관계 연산자 : select, project, join, division
- 일반 집합 연산자 : 합집합(Union), 교집합(Intersection), 차집합(Difference), 카티션 곱(Cartesian Product)
- 차수(Degree) : 속성
- 카디널리티(Cardinality) : 튜플의 수

![relation_algebra](/docs_images/relation_algebra.png)

## Select
릴레이션에 존재하는 튜플 중에서 선택 조건을 만족하는 튜플의 부분집합을 구해 새로운 릴레이션을 만드는 연산.

- 표기 : σ

## Project
![rdba_project](/docs_images/rdba_project.png)  
릴레이션에서 속성 리스트에 제시된 속성 값만을 추출하여 새로운 릴레이션을 만드는 연산.  
연산결과에 중복이 발생하면 중복을 제거함.

- 표기 : π

## Join
![rdba_join](/docs_images/rdba_join.png)  
공통속성을 중심으로 두개의 릴레이션을 하나로 합쳐서 새로운 릴레이션을 만드는 연산.  
- 릴레이션의 차수는 Join된 두 릴레이션의 차수를 합한 것과 같음.
- Cartesian Product(교차곱)를 수행한 다음 Select를 수행한 것과 같음.

- 표기 : ⨝

cf. 자연 조인(Natural Join)
조인 조건이 '='일 때 동일한 속성이 두번 나타나게 되는데, 이중 중복된 속성을 제거하여 같은 속성을 한번만 표기하는 방법.

## Division
![rdba_division](/docs_images/rdba_division.png)  
XↄY인 두개의 릴레이션 R(x), R(y)가 있을 때 R의 속성이 S의 속성값을 모두 가진 튜플에서 S가 가진 속성을 제외한 속성만을 구하는 연산
- Y의 속성으로 X에서 Select를 한 뒤, 결과값에서 Y의 속성을 전부 뺀 것과 동일
- 표기 : Ↄ

## 일반 집합 연산자
합집합(Union), 교집합(Intersection), 차집합(Difference)를 처리하기 위해서는 합병 조건을 만족해야 함.
- **합병 조건** : 합병하려는 두 릴레이션 간에 속성의 수가 같고 대응되는 속성별로 도메인이 같아야 함. 중복은 제거됨.

## 관계 해석
관계 데이터의 연산을 표현하는 방법으로 원하는 정보를 정의할 때는 계산 수식을 사용. **비절차적 언어**.

- **∀** : 전체정량자
For every
- **∀x** : 모든 x에 대해서 ~한 조건을 만족하면 참, 아니면 거짓
- **∃** : 존재정량자
For some
- **∃x** : ~한 조건을 만족하는 것이 하나라도 있다면 참, 없으면 거짓

# 정규화
잘못설계된 관계형 스키마를 더 작은 속성의 세트로 쪼개어 바람직한 스키마로 만들어가는 과정.

## 정규화 목적
- 구조 안정성 및 무결성 유지
- 데이터 중복을 배제하여 이상(Anomaly)의 발생 방지 & 저장공간 최소화
- 테이블 불일치 위험의 최소화
- 효과적인 검색알고리즘 생성

## 정규화 원칙
- 정보의 무손실 표현 : 하나의 스키마를 다른 스키마로 변환 시 정보의 손실이 있어서는 안된다.
- 분리의 원칙 : 하나의 독립된 관계성은 하나의 독립된 릴레이션으로 분리시켜 표현
- 데이터의 중복성 감소

## 이상(Anomaly) 

### 삽입 이상(Insertion Anomaly)
릴레이션에 데이터를 삽입할 때 의도와는 상관없이 원하지 않은 값들도 함께 삽입되는 현상

### 삭제 이상(Deletion Anomaly)
릴레이션에서 한 튜플을 삭제할 때 의도와는 상관없는 값들도 함께 삭제되는 연쇄가 일어나는 현상

### 갱신 이상(Update Anomaly)
릴레이션에서 튜플에 있는 속성값을 갱신할 때 일부 튜플의 정보만 갱신되어 정보에 모순이 생기는 현상

## [정규화 과정](https://www.youtube.com/watch?v=Y1FbowQRcmI)

### 1NF(제1정규형)
![1nf_before](/docs_images/1nf_before.png)  
![1nf_after](/docs_images/1nf_after.png)  
모든 도메인이 원자값으로만 구성된 정규형.

### 2NF(제2정규형)
![2nf_before](/docs_images/2nf_before.png)  
![2nf_after](/docs_images/2nf_after.png)   
현재 테이블의 주제와 관련없는 컬럼을 다른 테이블로 빼는 작업.
- 기본키가 아닌 모든 속성이 기본키에 대해 완전 **함수적 종속**을 만족하는 정규형
- Primary Key에 종속되어 있지 않은 놈들을 다 빼는 것
- **함수적 종속** : 데이터들이 어떤 기준값에 의해 종속되는 것

### 3NF(제3정규형)
![3nf_before](/docs_images/3nf_before.png)
![3nf_after](/docs_images/3nf_after.png)
일반 컬럼에 종속된 컬럼은 다른 테이블로 빼는 작업.
- 기본키가 아닌 모든 속성이 기본키에 대해 **이행적 종속**을 만족하지 않는 정규형
- 즉, Primary key에 종속된 상태(2NF)에서 일반 Key에 종속된 놈들을 다 빼는것.
- **이행적 종속** : A->B이고 B->C일 때 A->C를 만족하는 관계

### BCNF(Boyce-Codd 정규형)
릴레이션 R에서 결정자가 모두 후보키(Candidate Key)인 정규형

- **결정자(Determinant)** : 속성 간의 종속성을 규명할 때 기준이 되는 값.
- ex. 학번에 따라 이름이 결정되는 '학번 -> 이름'일 때, 학번을 결정자라고 하고 이름을 종속자라고 함. 

### 4NF
릴레이션 R에 다치 종속이 성립하는 경우 R의 모든 속성이 A에 함수적 종속 관계를 만족하는 정규형

- **다치 종속(Multi Valued Dependency)** : A,B,C 3개의 속성을 가진 릴레이션 R에서 어떤 복합 속성(A,C)에 대응하는 B값의 집합이 A값에만 종속되고 C값에는 무관하면, B는 A에서 다치 종속이라 한다.

### 5NF
릴레이션 R의 모든 Join 종속이 R의 후보키를 통해서만 성립되는 정규형
- **조인 종속** : 어떤 릴레이션 R의 속성에 대한 부분집합 A,B,...C가 있을 때 릴레이션 R이 자신의 Projection을 모두 Join한 결과가 자신과 동일할 경우 R은 조인 종속을 만족한다.


# 시스템 카탈로그
시스템 그 자체에 관련이 있는 다양한 객체에 관한 정보를 포함하는 시스템 데이터베이스
- 시스템 카탈로그에 저장된 정보를 메타데이터라 함.
- 카탈로그가 생성되면 데이터 사전(Data Dictionary)에 저장됨.
- DB 객체 정보 : 테이블, 인덱스, 뷰
- 사용자 정보 : ID, PW
- 테이블 무결성 제약조건 정보 : 기본키, 외래키, NULL값 허용여부
- 함수, 프로시저, 트리거 등의 정보
- DBMS가 스스로 생성하고 유지함.

## 카탈로그 참조를 위한 DBMS내 모듈 시스템
- 데이터 정의어 번역기(DDL Compiler)
- 데이터 조작어 번역기(DML Compiler)
- Data Directory : 데이터 사전에 수록된 데이터를 실제로 접근하는데 필요한 정보 유지
- 질의 최적화기
- 트랜잭션 처리기
